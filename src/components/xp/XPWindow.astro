---
import XPTitleBar from './XPTitleBar.astro';

interface Props {
  id: string;
  title: string;
  icon?: string;
  width?: number;
  height?: number;
  x?: number;
  y?: number;
  isOpen?: boolean;
  showMaximize?: boolean;
  resizable?: boolean;
  contentClass?: string;
}

const {
  id,
  title,
  icon,
  width = 600,
  height = 400,
  x = 100,
  y = 50,
  isOpen = false,
  showMaximize = true,
  resizable = true,
  contentClass = '',
} = Astro.props;

const baseUrl = import.meta.env.BASE_URL;
---

<div
  class:list={['xp-window', { 'xp-window--hidden': !isOpen }]}
  id={`window-${id}`}
  data-window-id={id}
  data-window-title={title}
  data-window-icon={icon ? `${baseUrl}${icon}` : ''}
  style={`width: ${width}px; height: ${height}px; left: ${x}px; top: ${y}px;`}
  role="dialog"
  aria-labelledby={`window-${id}-title`}
  tabindex="-1"
>
  <XPTitleBar
    title={title}
    icon={icon}
    windowId={id}
    showMaximize={showMaximize}
  />

  <div class="xp-window__body">
    <div class:list={['xp-window__content', 'xp-scrollbar', contentClass]}>
      <slot />
    </div>
  </div>

  {resizable && <div class="xp-window__resize" data-action="resize"></div>}
</div>

<style>
  .xp-window__content {
    line-height: 1.5;
    font-size: 12px;
    color: var(--xp-text-dark);
  }

  .xp-window__content h1,
  .xp-window__content h2,
  .xp-window__content h3,
  .xp-window__content h4,
  .xp-window__content h5 {
    color: var(--xp-text-dark);
    font-family: var(--xp-font-system);
    margin: 0 0 0.5em 0;
    line-height: 1.3;
  }

  .xp-window__content h1 { font-size: 20px; }
  .xp-window__content h2 { font-size: 16px; }
  .xp-window__content h3 { font-size: 14px; }
  .xp-window__content h4 { font-size: 12px; font-weight: bold; }

  .xp-window__content p {
    margin: 0 0 0.75em 0;
  }

  .xp-window__content ul,
  .xp-window__content ol {
    margin: 0 0 0.75em 1.5em;
    padding: 0;
  }

  .xp-window__content li {
    margin-bottom: 0.25em;
  }

  .xp-window__content a {
    color: #0066cc;
    text-decoration: none;
  }

  .xp-window__content a:hover {
    text-decoration: underline;
  }

  .xp-window__content strong {
    font-weight: bold;
  }

  .xp-window__content img {
    max-width: 100%;
    height: auto;
    border: 1px solid var(--xp-button-shadow);
  }
</style>
