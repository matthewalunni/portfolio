---
interface Props {
  title?: string;
  description?: string;
}

const { title = "Matthew Alunni - Portfolio", description = "Software Engineer Portfolio" } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content={description} />
    <title>{title}</title>

    <link rel="icon" type="image/svg+xml" href={`${baseUrl}/favicon.svg`} />

    <!-- Preload fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;700&display=swap" rel="stylesheet" />

    <!-- XP Styles -->
    <style is:global>
      @import '../styles/xp/index.css';

      /* Prevent text selection during drag */
      .xp-desktop.dragging * {
        user-select: none;
      }

      /* Mobile styles */
      @media (max-width: 768px) {
        .xp-desktop {
          padding-bottom: 56px;
          /* Background image works on mobile too */
          background-size: cover;
          background-position: center;
        }

        .xp-desktop__icons {
          grid-template-columns: repeat(3, 1fr);
          gap: 8px;
          padding: 16px;
          justify-items: center;
        }

        .xp-window {
          position: fixed !important;
          top: 0 !important;
          left: 0 !important;
          width: 100% !important;
          height: calc(100% - 56px) !important;
          border-radius: 0 !important;
          z-index: 500 !important;
        }

        .xp-window::before {
          border-radius: 0;
        }

        .xp-window__titlebar {
          border-radius: 0;
        }

        .xp-window__resize {
          display: none;
        }

        .xp-window__control-btn--minimize,
        .xp-window__control-btn--maximize {
          display: none;
        }

        .xp-taskbar {
          height: 56px;
        }

        .xp-start-btn {
          height: 44px;
          padding: 0 16px;
        }

        .xp-start-btn span {
          display: none;
        }

        .xp-taskbar__buttons {
          display: none;
        }

        .xp-taskbar__tray {
          padding: 0 16px;
        }

        .xp-taskbar__clock {
          font-size: 14px;
        }

        .xp-startmenu {
          width: 100%;
          bottom: 56px;
          left: 0;
          right: 0;
          max-height: 60vh;
          border-radius: 0;
        }

        .xp-startmenu__body {
          flex-direction: column;
        }

        .xp-startmenu__left,
        .xp-startmenu__right {
          width: 100%;
        }

        .xp-startmenu__right {
          border-top: 1px solid #d4d0c8;
        }

        /* Explorer sidebar hidden on mobile */
        .xp-explorer-sidebar {
          display: none;
        }
      }
    </style>
  </head>
  <body>
    <!-- Loading Screen -->
    <div class="xp-loading" id="xp-loading">
      <div class="xp-loading__logo">
        <svg viewBox="0 0 200 60" fill="none" xmlns="http://www.w3.org/2000/svg">
          <!-- Windows flag -->
          <rect x="10" y="10" width="16" height="16" fill="#ff0000" rx="2"/>
          <rect x="28" y="10" width="16" height="16" fill="#00ff00" rx="2"/>
          <rect x="10" y="28" width="16" height="16" fill="#0000ff" rx="2"/>
          <rect x="28" y="28" width="16" height="16" fill="#ffff00" rx="2"/>
          <!-- Text -->
          <text x="54" y="30" fill="#ffffff" font-family="Arial, sans-serif" font-size="16" font-weight="bold">Windows</text>
          <text x="54" y="46" fill="#ffffff" font-family="Arial, sans-serif" font-size="12" font-style="italic">XP</text>
          <text x="72" y="46" fill="#cccccc" font-family="Arial, sans-serif" font-size="10">Portfolio Edition</text>
        </svg>
      </div>
      <div class="xp-loading__bar">
        <div class="xp-loading__progress">
          <div class="xp-loading__block" style="animation-delay: 0s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.1s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.2s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.3s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.4s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.5s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.6s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.7s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.8s"></div>
          <div class="xp-loading__block" style="animation-delay: 0.9s"></div>
          <div class="xp-loading__block" style="animation-delay: 1.0s"></div>
          <div class="xp-loading__block" style="animation-delay: 1.1s"></div>
        </div>
      </div>
    </div>

    <slot />

    <!-- Scripts -->
    <script>
      import '../scripts/window-manager.ts';
      import '../scripts/sounds.ts';

      // Hide loading screen after a brief delay
      const loadingScreen = document.getElementById('xp-loading');
      if (loadingScreen) {
        setTimeout(() => {
          loadingScreen.classList.add('xp-loading--hidden');
          setTimeout(() => {
            loadingScreen.remove();
          }, 500);
        }, 1500);
      }
    </script>
  </body>
</html>
